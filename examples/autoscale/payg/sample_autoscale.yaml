---
imports:
  - path: autoscale.py
  - path: ../../modules/access/access.py
  - path: ../../modules/application/application.py
  - path: ../../modules/bigip-autoscale/bigip_autoscale.py
  - path: ../../modules/dag/dag.py
  - path: ../../modules/network/network.py
resources:
  - name: autoscale-py
    properties:
      appContainerName: f5devcentral/f5-demo-app:latest
      autoscalers:
        - description: My autoscale application
          name: f5-demo
          autoScalingPolicy:
            minNumReplicas: 1
            maxNumReplicas: 4
            cpuUtilization:
              utilizationTarget: 0.8
            coolDownPeriodSec: 60
          zone: us-west1-a
      bigIpRuntimeInitConfig: >-
        https://raw.githubusercontent.com/F5Networks/f5-google-gdm-templates-v2/v1.0.0.0/examples/autoscale/bigip-configurations/runtime-init-conf-payg.yaml
      bigIpRuntimeInitPackageUrl: >-
        https://cdn.f5.com/product/cloudsolutions/f5-bigip-runtime-init/v1.3.2/dist/f5-bigip-runtime-init-1.3.2-1.gz.run
      instanceGroupManagers:
        - description: My instance group
          name: f5-demo
          targetSize: 1
          zone: us-west1-a
      instanceTemplates:
        - description: My autoscale application
          hostname: test.example.com
          name: f5-demo
          networkInterfaces:
            - description: Interface used for external traffic
              network: >-
                https://www.googleapis.com/compute/v1/projects/myProject/global/networks/myNetwork
              subnetwork: >-
                https://www.googleapis.com/compute/v1/projects/myProject/regions/us-west1/subnetworks/mySubnet
              accessConfigs:
                - name: External NAT
                  type: ONE_TO_ONE_NAT
      healthChecks:
        - checkIntervalSec: 5
          description: my tcp healthcheck
          name: my-unique-tcp-healthcheck
          tcpHealthCheck:
            port: 44000
          timeoutSec: 5
          type: TCP
        - checkIntervalSec: 5
          description: my http healthcheck
          httpHealthCheck:
            port: 80
          name: my-unique-http-healthcheck
          timeoutSec: 5
          type: HTTP
      imageName: f5-bigip-16-1-0-0-0-19-payg-awf-plus-25mbps-210623021328
      instanceType: n1-standard-8
      targetPools:
        - region: us-west1
          name: my-target-pool
      region: us-west1
      restrictedSrcAddressApp: ''
      restrictedSrcAddressAppInternal: ''
      restrictedSrcAddressMgmt: ''
      uniqueString: myuniquestr
      update: false
      zone: us-west1-a
    type: autoscale.py
